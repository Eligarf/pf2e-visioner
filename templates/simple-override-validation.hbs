<div class="override-validation-modern" data-ui="override-v2">
  <!-- Header Section -->
  <div class="validation-header">
    <div class="header-icon">
      <i class="fas fa-exclamation-triangle"></i>
    </div>
    <div class="header-content">
      <h2>Override Validation Required</h2>
      <p class="subtitle">
        Token <strong>{{tokenName}}</strong> has moved. <strong>{{overrideCount}}</strong> override{{#unless (eq overrideCount 1)}}s{{/unless}} may no longer be valid and require your attention.
      </p>
    </div>
  </div>

  <!-- Target Header (like token manager) -->
  <div class="target-header">
    <div class="target-avatar">
      {{#if targetHeader.img}}
        <img src="{{targetHeader.img}}" alt="{{targetHeader.name}}" />
      {{else}}
        <i class="fas fa-crosshairs"></i>
      {{/if}}
    </div>
    <div class="target-meta">
      <div class="target-label">Target</div>
      <div class="target-name">{{targetHeader.name}}</div>
    </div>
  </div>

  <!-- Info Card -->
  <div class="info-card">
    <div class="info-icon">
      <i class="fas fa-lightbulb"></i>
    </div>
    <div class="info-content">
      <h4>What happened?</h4>
      <p>Movement or lighting changes can invalidate previously set visibility overrides. Review each override below to decide whether to keep or clear it.</p>
    </div>
  </div>

  <!-- Results Table (shared styling with action dialogs) -->
  <div class="results-table-container">
    <table class="visibility-table override-validation-table">
      <thead>
        <tr>
          <th class="observer">Observer</th>
          <th class="source">Source</th>
          <th class="status">Status</th>
          <th class="actions">Actions</th>
        </tr>
      </thead>
      <tbody>
        {{#each overrides}}
          <tr class="token-row" data-override-id="{{id}}">
            <td class="observer">
              <div class="chip chip--token observer">
                {{#if observerImg}}
                  <img class="chip-avatar" src="{{observerImg}}" alt="{{observerName}}"/>
                {{else}}
                  <i class="fas fa-eye"></i>
                {{/if}}
                <span class="chip-label">{{observerName}}</span>
              </div>
            </td>
            <td class="source">
              <div class="override-badge {{badgeClass}}">
                <i class="fas {{badgeIcon}}"></i>
                <span>{{badgeLabel}}</span>
              </div>
            </td>
            <td class="status">
              <div class="status-icons" role="group" aria-label="State change">
                <div class="state-row">
                  <button type="button" class="visioner-icon-btn prev-visibility" aria-label="{{prevVisibility.label}}" title="{{prevVisibility.label}}">
                    <i class="{{prevVisibility.icon}}" style="color: {{prevVisibility.color}};"></i>
                  </button>
                  <i class="fas fa-arrow-right state-arrow" aria-hidden="true"></i>
                  <button type="button" class="visioner-icon-btn status-visibility" aria-label="{{statusVisibility.label}}" title="{{statusVisibility.label}}">
                    <i class="{{statusVisibility.icon}}" style="color: {{statusVisibility.color}};"></i>
                  </button>
                </div>
                <div class="state-row">
                  <button type="button" class="visioner-icon-btn prev-cover" aria-label="{{prevCover.label}}" title="{{prevCover.label}}">
                    <i class="{{prevCover.icon}}" style="color: {{prevCover.color}};"></i>
                  </button>
                  <i class="fas fa-arrow-right state-arrow" aria-hidden="true"></i>
                  <button type="button" class="visioner-icon-btn status-cover" aria-label="{{statusCover.label}}" title="{{statusCover.label}}">
                    <i class="{{statusCover.icon}}" style="color: {{statusCover.color}};"></i>
                  </button>
                </div>
              </div>
              <div class="status-description" title="{{reason}}">
                <i class="fas fa-info-circle"></i>
                <span>{{#if currentVisibilityDescription}}{{currentVisibilityDescription}}{{else}}{{reason}}{{/if}}</span>
              </div>
            </td>
            <td class="actions">
              <div class="actions-section" style="display:flex;align-items:center;gap:8px;justify-content:flex-end;">
                <button type="button" class="row-action-btn revert-change btn btn-clear" data-override-id="{{id}}" title="Clear this override">
                  <i class="fas fa-times"></i>
                </button>
                <button type="button" class="row-action-btn apply-change btn btn-keep" data-override-id="{{id}}" title="Keep this override">
                  <i class="fas fa-check"></i>
                </button>
              </div>
            </td>
          </tr>
        {{/each}}
      </tbody>
    </table>
  </div>

  <!-- Bulk Actions (reuse action dialog look) -->
  <div class="sneak-preview-dialog-bulk-actions-header">
    <div class="sneak-preview-dialog-bulk-actions-info">Apply action to all overrides at once</div>
    <div class="sneak-preview-dialog-bulk-actions-buttons">
      <button type="button" class="bulk-action-btn revert-all btn-clear-all" data-tooltip="Remove all overrides">
        <i class="fas fa-times-circle"></i> Clear All
      </button>
      <button type="button" class="bulk-action-btn apply-all btn-keep-all" data-tooltip="Preserve all overrides">
        <i class="fas fa-check-circle"></i> Keep All
      </button>
    </div>
  </div>
</div>
<form class="pf2e-visioner-wall-manager">
  <div class="header-actions" style="display:flex; gap:8px; align-items:center; margin-bottom:8px;">
    <button type="button" class="visioner-btn" data-action="bulkHiddenOn"><i class="fas fa-eye"></i> Hidden: ON</button>
    <button type="button" class="visioner-btn" data-action="bulkHiddenOff"><i class="fas fa-eye-slash"></i> Hidden: OFF</button>
    <span style="flex:1"></span>
    <button type="button" class="visioner-btn" data-action="bulkProvideCoverOn"><i class="fas fa-shield-alt"></i> Provide Cover: ON</button>
    <button type="button" class="visioner-btn" data-action="bulkProvideCoverOff"><i class="fas fa-shield-slash"></i> Provide Cover: OFF</button>
  </div>

  <table class="visibility-table" style="width:100%">
    <thead>
      <tr>
        <th>Type</th>
        <th style="width:18%">Identifier</th>
        <th style="width:12%">Hidden Wall</th>
        <th style="width:12%">Provide Cover</th>
        <th style="width:20%">Cover Override</th>
        <th style="width:12%">Stealth DC</th>
        <th style="width:26%">Wall Id</th>
      </tr>
    </thead>
    <tbody>
      {{#each rows as |w|}}
        <tr data-wall-id="{{w.id}}">
          <td style="text-align:center">
            <img src="{{w.img}}" width="32" height="32" data-tooltip="{{#if (eq w.doorType 2)}}Secret Door{{else if (eq w.doorType 1)}}Door{{else}}Wall{{/if}}" />
          </td>
          <td>
            <input type="text" name="wall.{{w.id}}.identifier" value="{{w.identifier}}" placeholder="Hidden Wall" />
          </td>
          <td style="text-align:center">
            <input type="checkbox" name="wall.{{w.id}}.hiddenWall" {{#if w.hiddenWall}}checked{{/if}} data-tooltip="Mark this wall as hidden from players" />
          </td>
          <td style="text-align:center">
            <input type="checkbox" name="wall.{{w.id}}.provideCover" {{#if w.provideCover}}checked{{/if}} data-tooltip="This wall provides cover in combat" />
          </td>
          <td style="text-align:center">
            <div class="cover-override-buttons" style="display:{{#if w.provideCover}}flex{{else}}none{{/if}}; gap:2px; flex-wrap:wrap; justify-content:center;">
              <button type="button" class="visioner-icon-btn {{#unless w.coverOverride}}active{{/unless}}" 
                      data-action="setCoverOverride" data-wall-id="{{w.id}}" data-cover-override="auto" 
                      data-tooltip="Automatic Detection" title="Automatic Detection">
                <i class="fas fa-magic" style="color:#888"></i>
              </button>
              <button type="button" class="visioner-icon-btn {{#if (eq w.coverOverride 'none')}}active{{/if}}" 
                      data-action="setCoverOverride" data-wall-id="{{w.id}}" data-cover-override="none" 
                      data-tooltip="No Cover" title="No Cover">
                <i class="fas fa-ban" style="color:var(--cover-none)"></i>
              </button>
              <button type="button" class="visioner-icon-btn {{#if (eq w.coverOverride 'standard')}}active{{/if}}" 
                      data-action="setCoverOverride" data-wall-id="{{w.id}}" data-cover-override="standard" 
                      data-tooltip="Standard Cover" title="Standard Cover">
                <i class="fas fa-shield-alt" style="color:var(--cover-standard)"></i>
              </button>
              <button type="button" class="visioner-icon-btn {{#if (eq w.coverOverride 'greater')}}active{{/if}}" 
                      data-action="setCoverOverride" data-wall-id="{{w.id}}" data-cover-override="greater" 
                      data-tooltip="Greater Cover" title="Greater Cover">
                <i class="fas fa-shield-alt" style="color:var(--cover-greater)"></i>
              </button>
            </div>
          </td>
          <td>
            <input type="number" min="0" step="1" name="wall.{{w.id}}.dc" value="{{w.dc}}" />
          </td>
          <td><code>{{w.id}}</code></td>
        </tr>
      {{/each}}
    </tbody>
  </table>

  <footer class="sheet-footer" style="margin-top:8px; display:flex; gap:8px; justify-content:flex-end;">
    <button type="button" class="visioner-btn visioner-primary" data-action="apply"><i class="fas fa-check"></i> Apply</button>
    <button type="button" class="visioner-btn" data-action="close"><i class="fas fa-times"></i> Close</button>
  </footer>
</form>


